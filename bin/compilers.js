// Generated by LiveScript 1.6.0
(function(){
  var C, fs, log, md, formats, sass, compile, out$ = typeof exports != 'undefined' && exports || this;
  C = require('./config');
  fs = require('fs');
  require('ansicolor').nice;
  log = require('ololog').configure({
    tag: true,
    locate: false
  });
  md = require('markdown-it')({
    html: true
  });
  compose$(toPairs, forEach(function(it){
    var e;
    if (it[1]) {
      try {
        return md.use(require(resolve(it[0])), it[1]);
      } catch (e$) {
        e = e$;
        log.error('Missing module.');
        log('Run', 'npm install'.yellow, it[0].lightGreen);
        return process.exit(1);
      }
    }
  }))(
  C['markdown-it-plugins']);
  function resolve(module){
    var local;
    local = process.cwd() + '/node_modules/' + module;
    if (fs.existsSync(local)) {
      return local;
    } else {
      return module;
    }
  }
  formats = {
    js: {
      ls: function(){
        var livescript;
        livescript = require('livescript');
        return livescript.compile(arguments[0], (import$({
          filename: arguments[1]
        }, arguments[2])));
      }
    },
    css: {
      styl: function(){
        var stylus;
        stylus = require('stylus');
        return stylus.render(arguments[0], {
          filename: arguments[1]
        });
      },
      scss: function(){
        return sass(arguments[0], {
          file: arguments[1],
          indented: false
        });
      },
      sass: function(){
        return sass(arguments[0], {
          file: arguments[1],
          indented: true
        });
      }
    },
    html: {
      md: function(){
        return md.render(arguments[0]);
      },
      pug: function(){
        var pug;
        pug = require('pug');
        return pug.render(arguments[0], (import$({
          filename: arguments[1]
        }, arguments[2])));
      },
      njk: function(){
        var nunjucks;
        nunjucks = require('nunjucks');
        return nunjucks.renderString(arguments[0], arguments[2]);
      }
    }
  };
  sass = function(text, arg$){
    var filename, indented, sass;
    filename = arg$.filename, indented = arg$.indented;
    sass = require('sass');
    return sass.renderSync({
      data: text,
      file: filename,
      indentedSyntax: indented
    }).css.toString();
  };
  compile = function(dst, src, text, filename, vars){
    if (dst === src || !dst) {
      return Promise.resolve(text);
    }
    return Promise.resolve(formats[dst][src](text, filename, vars));
  };
  out$.formats = formats;
  out$.compile = compile;
  out$.resolve = resolve;
  function compose$() {
    var functions = arguments;
    return function() {
      var i, result;
      result = functions[0].apply(this, arguments);
      for (i = 1; i < functions.length; ++i) {
        result = functions[i](result);
      }
      return result;
    };
  }
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);
